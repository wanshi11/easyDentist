<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="" />
<title>新闻中心</title>
<link type="text/css" href="/css/style.css" rel="stylesheet"/>
<link type="text/css" rel="stylesheet" href="/css/index.css"  />
<link type="text/css" rel="stylesheet" href="/css/news.css"  />
<link type="text/css" rel="stylesheet" href="/layui_v2.3.0/css/layui.css"  />

<script type="text/javascript" src="/js/jquery-1.8.3.min.js"></script>
<style type="text/css">
.layui-laypage {
    margin: -18px 0 0 25%;
}
</style>
</head>

<body>
<#include "/common/home_header.html"/>
<!--轮播器 -->
   <#include "/common/home_lunbo.html"/>
<!--轮播器 -->

<!--牙科项目介绍 -->
    <#include "/common/home_oral.html"/>
<!--牙科项目介绍 -->

<div class="newcenter_main">
<div class="new_left">
<div class="new_div">
<div class="new_btns">
<button class="new_btn" value="ARTICLE_NEWS">新闻动态</button>
<button class="new_btn" value="ARTICLE_HEALTH">口腔知识</button>
<button class="new_btn" value="ARTICLE_GY_ACTIVITY">优惠活动</button>
<button class="new_btn" value="ARTICLE_YH_ACTIVITY">公益活动</button>
</div>
<div class="new_art" id="newsInfo">

</div>
</div>
 <div id="pageView">
 </div>
 <input type="hidden" value="${informationCodeList.TotalPages}" id="pageTotal"> <!-- 总条数 -->
<input type="hidden" value="${informationCodeList.number+1}" id="page">　　<!-- 第几页 -->
 
 
</div>
<div class="new_right">
</div>
</div>
<#include "/common/home_footer.html"/>
<script src="/layui_v2.3.0/layui.all.js"  charset="utf-8" ></script>
<script>
$(document).ready(function(){
	
    //ajax请求后台数据
    getNewsPageInfo();
	
    toPage();

});

	//分页参数设置 这些全局变量关系到分页的功能
	var startAllAppoint = 0;//开始页数
	var limitAllAppoint = 10;//每页显示数据条数
	var currentPageAllAppoint = 1;//当前页数
	var dataLength = 0;//数据总条数
	//ajax请求后台数据
	function getNewsPageInfo(){
		$.ajax({
			type:"post",
			async:false,
			url:"${request.contextPath}/news/getPageInfo",
			data:{
        	type:"ARTICLE_NEWS",
        	currentPage:startAllAppoint
        },
			success:function(result,status){
				data=eval("("+result+")");
				getNewsView(result.datas);
				startAllAppoint = result.currentPage;//当前页数(后台返回)
				dataLength  = result.total;//数据总条数
			}
		});
		
	}
	
	function getNewsView(data){
		var s = "<tr><th>姓名</th><th>性别</th><th>电话</th><th>备案楼盘</th><th>已成交</th><th>归属经纪人</th><th>添加时间</th></tr>";
		$.each(data,function(v,o){
				s+='<tr><td>'+111+'</td>';
				s+='<td>'+222+'</td>';
				s+='<td>'+333+'</td>';
				s+='<td>'+444+'</td>';
				s+='<td>'+555+'</td>';
				s+='<td>'+666+'</td>';
				s+='<td>'+777+'</td></tr>';
		});
		if(data.length>0){
			alert(11);
			$("#newsInfo").html(s);
		}else{
			$("#page1").hide();
			$("#newsInfo").html("<br/><span style='width:10%;height:30px;display:block;margin:0 auto;'>暂无数据</span>");
		}
		
		
	}
	
	function toPage(){
		
		layui.use(['laypage', 'layer'], function(){
			  var laypage = layui.laypage
			  ,layer = layui.layer;
			  
			  laypage.render({
				    elem: 'pageView'
				    ,count: dataLength //这个是后台返回的数据的总条数
				    ,limit: limitAllAppoint   //每页显示的数据的条数,layui会根据count，limit进行分页的计算
				    ,theme: '#FFB800'
				    ,curr: currentPageAllAppoint
					,skip: true
					,jump: function(obj, first){
					    	
					    	currentPageAllAppoint = obj.curr;
					    	startAllAppoint = (obj.curr-1)*obj.limit;
					    	
					      if(!first){ //一定要加此判断，否则初始时会无限刷新
					    	  getNewsPageInfo();//一定要把翻页的ajax请求放到这里，不然会请求两次。
					        
					      }
					    }
			  
			});
		
	});
	};
</script>
<script>
/* $(document).ready(function(){
	
layui.use(['laypage', 'layer'], function(){
  var laypage = layui.laypage
  ,layer = layui.layer;
  
  laypage.render({
	    elem: 'pageView'
	    ,count: 31
	    ,limit: 10
	    ,theme: '#FFB800'
	    ,jump: function(obj, first){
	    	console.log(obj);
	    	console.log(first);
	    	        //得到了当前页，用于向服务端请求对应数据
	    	        var curr = obj.curr -1;
	    	        var self  = this;
	    	        console.log(self);
	    	        
	    	        $.ajax({
	    		        //几个参数需要注意一下
	    		            type: "POST",//方法类型
	    		            url: "${request.contextPath}/news/getPageInfo" ,//url
	    		            data: {
	    		            	type:"ARTICLE_NEWS",
	    		            	currentPage:curr
	    		            },
	    		            success: function (result) {
	    		            	console.log(result);
	    		            	
	    		            },
	    		            error: function(XMLHttpRequest, textStatus, errorThrown) {
	    		            	 alert(XMLHttpRequest.status);
	    		            	 alert(XMLHttpRequest.readyState);
	    		            	 alert(XMLHttpRequest.responseText);
	    		            	 alert(textStatus);
	    		            }
	    		        });
	    	    }
	  });
  
});
}); */
</script>

</body>
</html>